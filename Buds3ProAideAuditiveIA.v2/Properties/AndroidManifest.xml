<?xml version="1.0" encoding="utf-8"?>
<manifest
    xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.companyname.buds3proaidia"
    android:installLocation="auto"
    android:versionCode="120003"
    android:versionName="1.2.0">

  <!-- Ciblage Play Store 2025 -->
  <uses-sdk
      android:minSdkVersion="24"
      android:targetSdkVersion="35" />

  <!-- Audio -->
  <uses-permission android:name="android.permission.RECORD_AUDIO" />
  <uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
  <uses-permission android:name="android.permission.WAKE_LOCK" />

  <!-- Bluetooth :
       - API <= 30 : anciennes permissions (bridées via maxSdkVersion)
       - API 31+   : BLUETOOTH_CONNECT (et BLUETOOTH_SCAN si scan) -->
  <uses-permission android:name="android.permission.BLUETOOTH" android:maxSdkVersion="30" />
  <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" android:maxSdkVersion="30" />
  <uses-permission
      android:name="android.permission.BLUETOOTH_CONNECT"
      android:usesPermissionFlags="neverForLocation" />
  <!-- Décommente uniquement si tu scannes des appareils :
  <uses-permission
      android:name="android.permission.BLUETOOTH_SCAN"
      android:usesPermissionFlags="neverForLocation" />
  <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" android:maxSdkVersion="30" />
  -->

  <!-- Foreground Service (obligatoire depuis Android 9 / API 28) -->
  <uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
  <!-- Types spécifiques Android 14+ (API 34) -->
  <uses-permission android:name="android.permission.FOREGROUND_SERVICE_MEDIA_PLAYBACK" />
  <uses-permission android:name="android.permission.FOREGROUND_SERVICE_MICROPHONE" />

  <!-- Android 13+ (API 33) : notifications runtime -->
  <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />

  <!-- Capacités matérielles -->
  <uses-feature android:name="android.hardware.microphone" android:required="true" />
  <uses-feature android:name="android.hardware.audio.low_latency" android:required="false" />

  <application
      android:label="@string/app_name"
      android:icon="@mipmap/ic_launcher"
      android:roundIcon="@mipmap/ic_launcher_round"
      android:allowBackup="true"
      android:supportsRtl="true"
      android:usesCleartextTraffic="false"
      android:theme="@style/Theme.Sonara.Dark">

    <!-- Déclare le service si tu ne mets pas l’attribut C# [Service(...)] -->
    <!-- Remplace .AudioForegroundService par ton nom réel de classe si différent -->
    <service
        android:name=".AudioForegroundService"
        android:exported="false"
        android:foregroundServiceType="mediaPlayback|microphone" />
    <!-- Si tu utilises l'attribut C#, supprime ce bloc <service>. -->

    <!-- MainActivity peut rester décorée côté C# avec [Activity(..., MainLauncher=true, Exported=true)] -->
  </application>
</manifest>
